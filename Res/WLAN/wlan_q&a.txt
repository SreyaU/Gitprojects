wlan Q&A
===========================================================================
-->three main types of 802.11 frame types:

Management Frames
Control Frames
Data Frames

🔹 1. Management Frames
Used for establishing and maintaining communication between AP and STA.

Frame Type	Function	Example in WLAN Test
Beacon	AP advertises presence & settings	Check if SSID is visible in scan
Probe Request/Response	STA discovers APs	Passive/Active scan tests
Authentication	STA starts connection sequence	Validate open/WPA2 auth step
Association Req/Resp	Finalizes connection	Verify association success/failure

🔹 2. Control Frames
Used to coordinate access to the medium (channel).

Frame Type	Function	Example in WLAN Test
RTS/CTS	Avoid hidden node collision	Test hidden node mitigation
ACK	Acknowledge frame reception	Monitor ACK loss due to interference
Block ACK	Acknowledge multiple frames	Test high throughput scenarios (AMPDU)

🔹 3. Data Frames
Carry user/application data between client and AP.

Frame Type	Function	Example in WLAN Test
Data	Actual payload transmission	Ping, throughput, file transfer test
QoS Data	Prioritized traffic (voice/video)	VoIP/Wi-Fi calling QoS validation

-->🔹 Correct Explanation: WPA2-Personal 4-Way Handshake
🧩 Purpose:
The 4-way handshake is used to:

Prove possession of a shared Pairwise Master Key (PMK)

Derive fresh session keys (PTK, GTK)

Establish encrypted unicast and broadcast communication

🔁 Sequence:
Msg #	From → To	Contents	Purpose
1	AP → STA	ANonce, AP RSN IE	AP sends its nonce to begin key generation
2	STA → AP	SNonce, RSN IE, MIC	STA generates PTK, sends its nonce + MIC
3	AP → STA	Install PTK, GTK, MIC	AP verifies MIC, sends GTK encrypted with PTK
4	STA → AP	ACK + MIC	Confirms installation of PTK & GTK

🔐 Keys:
PMK: Derived from the PSK (WPA2-Personal)

PTK: Pairwise Transient Key (derived from PMK, ANonce, SNonce, MACs)

GTK: Group Temporal Key (used for multicast/broadcast; generated by AP)

🔬 Wireshark Verification:
To confirm success:

Capture EAPOL packets (filter: eapol)

Ensure you see 4 packets: M1 → M4

Check for "Message 4 of 4" and no retransmissions

Inspect MIC field: if incorrect, Wireshark flags “MIC failure” or decryption fails

Confirm data packets follow handshake (encrypted 802.11 data)